<div class="data-filter form-inline">
    <div class="bts-search">
        <button id="bt-search" mat-raised-button color="primary" (click)="onSearch()"> Поиск </button> 
        <br>
        <button id="bt-clear" mat-raised-button (click)="onClear()"> Очистить </button> 
    </div>
    <div class="search-input">
        <mat-form-field id="only" appearance="outline">
            <mat-label> НПЦ </mat-label>
            <input matInput placeholder="Поиск" [(ngModel)]="searchNpc" data-placement="bottom" matTooltip="Поле НПЦ">
        </mat-form-field>
        <br>
        <mat-form-field id="only" appearance="outline">
            <mat-label> ЗПЦ </mat-label>
            <input matInput placeholder="Поиск" [(ngModel)]="searchZpc" data-placement="bottom" matTooltip="Поле ЗПЦ">
        </mat-form-field>
    </div>
</div>    

<mat-divider></mat-divider>

<div class="form-inline cards">
    <app-card-unloading [data]="cardSend"></app-card-unloading>
    <app-card-unloading [data]="cardPart"></app-card-unloading>
    <app-card-unloading [data]="cardNotData"></app-card-unloading>
</div>

<div class="mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" class="table-hover" matSort>

        <ng-container matColumnDef="doc_num">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> № Документ </th>
            <td mat-cell *matCellDef="let element"> {{element.doc_num}} </td>
        </ng-container>   
        
        <ng-container matColumnDef="article">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Артикул </th>
            <td mat-cell *matCellDef="let element"> {{element.article}} </td>
        </ng-container>

        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Наименование </th>
            <td mat-cell *matCellDef="let element"> {{element.name}} </td>
        </ng-container>

        <ng-container matColumnDef="count">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Количество </th>
            <td mat-cell *matCellDef="let element"> {{element.count}} </td>
        </ng-container>   
        
        <ng-container matColumnDef="mesabbrev">
            <th mat-header-cell *matHeaderCellDef> Ед. изм. </th>
            <td mat-cell *matCellDef="let element"> {{element.mesabbrev}} </td>
        </ng-container>

        <ng-container matColumnDef="ost_main">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Остаток осн. </th>
            <td mat-cell *matCellDef="let element"> {{element.ost_main}} </td>
        </ng-container>

        <ng-container matColumnDef="ost_braq">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Остаток брак </th>
            <td mat-cell *matCellDef="let element"> {{element.ost_braq}} </td>
        </ng-container>

        <ng-container matColumnDef="count_export">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Отгружено </th>
            <td mat-cell *matCellDef="let element"> {{element.count_export}} </td>
        </ng-container>

        <ng-container matColumnDef="place">
            <th mat-header-cell *matHeaderCellDef> Место хранения </th>
            <td mat-cell *matCellDef="let element"> {{element.place}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            
    </table>
</div>

<div class="mat-elevation-z8">
    <table mat-table class="table-hover">

        <ng-container matColumnDef="npc">
            <th mat-header-cell *matHeaderCellDef> НПЦ </th>
            <td mat-cell *matCellDef="let element"> 
                <mat-accordion>
                    <mat-expansion-panel *ngFor="let npc of listNpc">
                        <mat-expansion-panel-header>
                            {{npc.NPC_NAME}}
                        </mat-expansion-panel-header>
                        {{npc.ANY_DATA1}} - {{npc.ANY_DATA2}} - {{npc.NY_DATA3}}
                        <div class="mat-elevation-z8">
                            <table mat-table [dataSource]="npc.Body" class="table-hover">

                                <ng-container matColumnDef="article">
                                    <th mat-header-cell *matHeaderCellDef> НПЦ </th>
                                    <td mat-cell *matCellDef="let element"> {{element.article}} </td>
                                </ng-container>   
                                
                                <ng-container matColumnDef="name">
                                    <th mat-header-cell *matHeaderCellDef> Дата </th>
                                    <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                                </ng-container>

                                <ng-container matColumnDef="count">
                                    <th mat-header-cell *matHeaderCellDef> Откуда </th>
                                    <td mat-cell *matCellDef="let element"> {{element.count}} </td>
                                </ng-container>

                                <ng-container matColumnDef="count_main">
                                    <th mat-header-cell *matHeaderCellDef> Куда </th>
                                    <td mat-cell *matCellDef="let element"> {{element.count_main}} </td>
                                </ng-container>

                                <ng-container matColumnDef="count_braq">
                                    <th mat-header-cell *matHeaderCellDef> Куда </th>
                                    <td mat-cell *matCellDef="let element"> {{element.count_braq}} </td>
                                </ng-container>

                                <ng-container matColumnDef="place">
                                    <th mat-header-cell *matHeaderCellDef> Куда </th>
                                    <td mat-cell *matCellDef="let element"> {{element.place}} </td>
                                </ng-container>
                        
                                <tr mat-header-row *matHeaderRowDef="displayedCurrentPcColumns; sticky: true"></tr>
                                <tr mat-row *matRowDef="let row; columns: displayedCurrentPcColumns;"></tr>
                                    
                            </table>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </td>
        </ng-container>   
        
        <ng-container matColumnDef="zpc">
            <th mat-header-cell *matHeaderCellDef> ЗПЦ </th>
            <td mat-cell *matCellDef="let element"> 
                <mat-accordion>
                    <mat-expansion-panel *ngFor="let zpc of listZpc">
                        <mat-expansion-panel-header>
                            {{npc.NPC_NAME}}
                        </mat-expansion-panel-header>
                        {{npc.ANY_DATA1}} - {{npc.ANY_DATA2}} - {{npc.NY_DATA3}}
                        <div class="mat-elevation-z8">
                            <table mat-table [dataSource]="zpc.Body" class="table-hover">

                                <ng-container matColumnDef="article">
                                    <th mat-header-cell *matHeaderCellDef> НПЦ </th>
                                    <td mat-cell *matCellDef="let element"> {{element.article}} </td>
                                </ng-container>   
                                
                                <ng-container matColumnDef="name">
                                    <th mat-header-cell *matHeaderCellDef> Дата </th>
                                    <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                                </ng-container>

                                <ng-container matColumnDef="count">
                                    <th mat-header-cell *matHeaderCellDef> Откуда </th>
                                    <td mat-cell *matCellDef="let element"> {{element.count}} </td>
                                </ng-container>

                                <ng-container matColumnDef="count_main">
                                    <th mat-header-cell *matHeaderCellDef> Куда </th>
                                    <td mat-cell *matCellDef="let element"> {{element.count_main}} </td>
                                </ng-container>

                                <ng-container matColumnDef="count_braq">
                                    <th mat-header-cell *matHeaderCellDef> Куда </th>
                                    <td mat-cell *matCellDef="let element"> {{element.count_braq}} </td>
                                </ng-container>

                                <ng-container matColumnDef="place">
                                    <th mat-header-cell *matHeaderCellDef> Куда </th>
                                    <td mat-cell *matCellDef="let element"> {{element.place}} </td>
                                </ng-container>
                        
                                <tr mat-header-row *matHeaderRowDef="displayedCurrentPcColumns; sticky: true"></tr>
                                <tr mat-row *matRowDef="let row; columns: displayedCurrentPcColumns;"></tr>
                                    
                            </table>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedPcColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedPcColumns;"></tr>
            
    </table>
</div>